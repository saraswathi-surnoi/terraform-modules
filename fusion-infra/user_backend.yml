users:
  - name: devops
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    groups: sudo, docker
    home: /home/devops
    shell: /bin/bash
    lock_passwd: false
    plain_text_passwd: "Devops@321"

ssh_pwauth: true
disable_root: true

runcmd:
  # Enable password authentication for SSH
  - sed -i 's/^#PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config
  - sed -i 's/^PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config
  - systemctl restart sshd

  # Update system
  - apt update -y
  - apt upgrade -y

  # Install dependencies
  - apt install -y git wget curl unzip apt-transport-https ca-certificates gnupg lsb-release software-properties-common

  # ---------------- JAVA 21 ----------------
  - apt install -y openjdk-21-jdk
  - java -version

  # ---------------- MAVEN ----------------
  - wget -q https://archive.apache.org/dist/maven/maven-3/3.9.8/binaries/apache-maven-3.9.8-bin.tar.gz -P /tmp
  - tar xf /tmp/apache-maven-3.9.8-bin.tar.gz -C /opt
  - ln -s /opt/apache-maven-3.9.8 /opt/maven
  - echo 'export M2_HOME=/opt/maven' > /etc/profile.d/maven.sh
  - echo 'export PATH=$PATH:/opt/maven/bin' >> /etc/profile.d/maven.sh
  - chmod +x /etc/profile.d/maven.sh

  # ---------------- DOCKER ----------------
  - apt remove -y docker docker-engine docker.io containerd runc || true
  - apt install -y docker.io
  - systemctl enable docker
  - systemctl start docker
  - usermod -aG docker devops
